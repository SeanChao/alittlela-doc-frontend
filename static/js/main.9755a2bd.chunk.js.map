{"version":3,"sources":["api/request.js","component/NavPage.js","api/service.js","component/Lucksheet.js","component/SheetPage.js","App.js","reportWebVitals.js","index.js"],"names":["api","process","REACT_APP_API_URL","axios","defaults","baseURL","axiosRequest","method","url","options","auth","payload","params","requestConfig","data","window","localStorage","headers","Authorization","getItem","cookie","load","Promise","resolve","reject","then","res","status","console","log","catch","err","get","TrashIcon","xmlns","className","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","CreateIcon","DocItem","title","link","onDelete","props","href","onClick","NavPage","useState","files","setFiles","newFilename","setNewFilename","useEffect","onDeleteClick","ele","path","placeholder","value","onChange","ev","target","filename","createFile","map","e","idx","Math","round","random","sheetPropsEqual","prevProps","nextProps","myFolderUrl","Sheet","React","memo","luckysheet","create","container","plugins","id","row","column","cancel","SheetPage","useParams","userid","socketUrl","loadUrl","useWebSocket","sendJsonMessage","lastMessage","readyState","useMemo","cellData","JSON","parse","action","user","sheet","getCellValue","setCellValue","updateData","clearCell","connectionStatus","ReadyState","CONNECTING","OPEN","CLOSING","CLOSED","UNINSTANTIATED","cellUpdateBefore","args","cellUpdated","constructWriteMessage","message","stringify","rangeSelect","constructMessageFromRangeSelect","cellEditBefore","constructMessageFromCellEdit","gridKey","hook","Home","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9755a2bd.chunk.js","sourcesContent":["import axios from 'axios';\nimport cookie from 'react-cookies';\n\n// API URL config\nconst api =\n  process.env.REACT_APP_API_URL === null ? '' : process.env.REACT_APP_API_URL;\n\naxios.defaults.baseURL = api;\n\nconst axiosRequest = (method, url = '', options = {}) => {\n  const auth = options.auth;\n  const payload = options.payload;\n  const params = options.params;\n  const requestConfig = {\n    method,\n    url,\n    params,\n    data: payload,\n  };\n  if (auth) {\n    if (!window.localStorage) {\n      requestConfig.headers = {\n        Authorization: cookie.load('auth_token'),\n      };\n    } else {\n      requestConfig.headers = {\n        Authorization: localStorage.getItem('auth_token'),\n      };\n    }\n  }\n\n  return new Promise((resolve, reject) =>\n    axios(requestConfig)\n      .then((res) => {\n        if (res.status === 200) {\n          resolve(res.data);\n        } else {\n          // eslint-disable-next-line\n          console.log(res);\n          reject(res);\n        }\n      })\n      .catch((err) => {\n        reject(err);\n      })\n  );\n};\n\nexport const get = (url, params = {}, auth = false) =>\n  axiosRequest('get', url, { params, auth });\n\nexport const post = (url, data = {}, auth = false) =>\n  axiosRequest('post', url, { payload: data, auth });\n\n/**\n * Send an HTTP PUT request, returns a Promise\n * @param {string} url (relative) request url\n * @param {Object} data payload data\n * @param {boolean} auth whether to attach authorization header\n */\nexport const put = (url, data = {}, auth = false) =>\n  axiosRequest('put', url, { payload: data, auth });\n","import React, { useEffect, useState } from 'react';\nimport { createFile, deleteFile, getFiles } from '../api/service';\n\nconst TrashIcon = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    className=\"h-6 w-6\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth={2}\n      d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"\n    />\n  </svg>\n);\n\nconst CreateIcon = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    className=\"h-6 w-6\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth={2}\n      d=\"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n    />\n  </svg>\n);\n\nconst DocItem = ({ title, link, onDelete, ...props }) => {\n  return (\n    <div {...props}>\n      <a className=\"w-full text-gray-800\" href={`/sheet/${link ? link : ''}`}>\n        <p>{title}</p>\n      </a>\n      <button\n        onClick={onDelete}\n        className=\"flex-no-shrink p-2 ml-2 border-2 rounded text-red-300 border-red-300 hover:text-white hover:bg-red-300\"\n      >\n        <TrashIcon />\n      </button>\n    </div>\n  );\n};\n\nconst NavPage = () => {\n  const [files, setFiles] = useState([]);\n  const [newFilename, setNewFilename] = useState('');\n\n  useEffect(() => {\n    getFiles()\n      .then((res) => setFiles(res.files))\n      .catch((err) => console.log(err));\n  }, []);\n\n  const onCreateClick = () => {\n    const filename = newFilename;\n    createFile(filename);\n  };\n\n  const onDeleteClick = (ele) => {\n    deleteFile(ele);\n  };\n\n  const randomUserName = () => `user${Math.round(Math.random() * 1000)}`;\n\n  return (\n    <div className=\"bg-white rounded shadow w-full lg:w-3/4 lg:max-w-lg\">\n      <div className=\"mb-4 p-10\">\n        <h1 className=\"text-gray-700 text-4xl font-bold\">Your Docs</h1>\n        <div className=\"flex mt-4\">\n          <input\n            className=\"shadow appearance-none border rounded w-full py-2 px-3 mr-4 text-grey-darker\"\n            placeholder=\"Create a new sheet...\"\n            value={newFilename}\n            onChange={(ev) => setNewFilename(ev.target.value)}\n          ></input>\n          <button\n            className=\"flex-no-shrink p-2 border-2 rounded text-green-300 border-green-300 hover:text-white hover:bg-green-300\"\n            onClick={onCreateClick}\n          >\n            <CreateIcon />\n          </button>\n        </div>\n      </div>\n      <div className=\"divide-y\">\n        {files.map((e, idx) => (\n          <DocItem\n            key={idx}\n            title={e}\n            link={`${e}/${randomUserName()}`}\n            onDelete={() => onDeleteClick(e)}\n            className=\"flex pb-4 pt-4 pl-10 pr-10 items-center hover:bg-gray-50\"\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default NavPage;\n","import { get } from './request';\n/**\n * 前后端交互：\ncreate, delete\nopen, lock cell, update content, unlock cell, close file\ntrash bin\n */\n\n/**\n * Home Page\n */\n\nexport const getFiles = () => {\n  return get('/files');\n};\n\n/**\n * create a new spreadsheet\n * @param {string} filename the name of the new file\n */\nexport const createFile = (filename) => {\n  return get('/create', { path: filename });\n};\n\nexport const deleteFile = (filename) => {\n  return get('/delete', { path: filename });\n};\n\nexport const getBin = () => {\n  return get('/bin');\n};\n","/* eslint-disable react/prop-types */\nimport React, { useEffect } from 'react';\n\n/**\n * compare the previous and next props and determine whether to update the component\n * true: equal, do not update\n * false: not equal, update\n */\nconst sheetPropsEqual = (prevProps, nextProps) => {\n  return (\n    prevProps.data == nextProps.data &&\n    prevProps.myFolderUrl == nextProps.myFolderUrl &&\n    prevProps.title == nextProps.title\n  );\n};\n/**\n * Lucksheet instance\n * options.data: sheet file data, ref: https://mengshukeji.github.io/LuckysheetDocs/guide/config.html\n *\n * @param {*} options luckysheet configuration options\n * @param  {...any} props other HTML props\n * @returns\n */\nconst Sheet = React.memo(function SheetComponent({ options, ...props }) {\n  useEffect(() => {\n    const luckysheet = window.luckysheet;\n    luckysheet.create({\n      container: 'luckysheet',\n      plugins: ['chart'],\n      ...options,\n    });\n  });\n  return <div id=\"luckysheet\" {...props}></div>;\n}, sheetPropsEqual);\n\nexport default Sheet;\n","import { Sheet } from './index';\nimport React, { useMemo } from 'react';\nimport { useParams } from 'react-router';\nimport useWebSocket, { ReadyState } from 'react-use-websocket';\n\n//const WS_API = process.env.REACT_APP_WS_URL;\nlet row=null,column=null;\nlet cancel=0;\n\nconst SheetPage = (...props) => {\n  // WebSocket config\n  let { filename,userid } = useParams();\n  const  socketUrl='ws://localhost:8080/ws?user='+userid+'&path='+filename  //'wss://echo.websocket.org'  // `${WS_API}`;\n  const loadUrl='http://localhost:8080/read?user='+userid+'&path='+filename\n\n  const { sendJsonMessage, lastMessage, readyState } = useWebSocket(socketUrl);\n\n  // received message\n  useMemo(() => {\n    console.log('lastMessage-----------------------------');\n    if(lastMessage==null)\n      return\n    var data = JSON.parse(lastMessage.data)\n    console.log(data)\n    let cellData\n    switch (data.action){\n      case 'lock':\n        //todo lock the cell\n        console.log(data.user, ' lock ', data.sheet, '-', data.column, '-', data.row)\n        if (data.user !== userid) {\n          let value = window.luckysheet.getCellValue(data.row, data.column);\n          cellData={}\n          if(value!==null)\n            cellData['v']=value\n          cellData[\"bg\"]='#808080'\n          cellData[\"lock\"]='1'\n          window.luckysheet.setCellValue(data.row, data.column, cellData);\n        }else{\n          row=data.row\n          column=data.column\n          console.log(row,column)\n        }\n        break\n      case 'unlock':\n        console.log(data.user, ' unlock ', data.sheet, '-', data.column, '-', data.row);\n        if (data.user !== userid) {\n          let value = window.luckysheet.getCellValue(data.row, data.column);\n          cellData={}\n          if(value!==null)\n            cellData['v']=value\n          cellData[\"bg\"]=null\n          cellData[\"lock\"]=null\n          window.luckysheet.setCellValue(data.row, data.column, cellData);\n        }else{\n          row=null\n          column=null\n        }\n        break;\n      case 'write':\n        //todo after writing, the cell lock will be release automatically\n        console.log(data.user,' write ',data.sheet,'-',data.column,'-',data.row)\n        cellData=JSON.parse(data.updateData)\n        cellData[\"bg\"]=null\n        cellData[\"lock\"]=null\n        window.luckysheet.clearCell(data.row, data.column)\n        window.luckysheet.setCellValue(data.row,data.column,cellData)\n        if(data.user===userid){\n          row=null\n          column=null\n        }\n        break\n      default:\n        console.log('other message')\n    }\n  }, [lastMessage]);\n\n  const connectionStatus = {\n    [ReadyState.CONNECTING]: 'Connecting',\n    [ReadyState.OPEN]: 'Open',\n    [ReadyState.CLOSING]: 'Closing',\n    [ReadyState.CLOSED]: 'Closed',\n    [ReadyState.UNINSTANTIATED]: 'Uninstantiated',\n  }[readyState];\n\n  //write\n  const cellUpdateBefore = (...args) => {\n    console.log('update before------------------------------')\n    if(cancel===1)\n      cancel=0;\n    console.log(args);\n  };\n  const cellUpdated = (...args) => {\n    console.log('cell updated------------------------------')\n    console.log(args);\n    console.log(row,column)\n    if(args[3][\"lock\"]!=='1'&&row===args[0]&&column===args[1]) {\n      console.log('send write message');\n      sendJsonMessage(constructWriteMessage(...args));\n    }\n  };\n  //after write\n  const  constructWriteMessage=(...args)=>{\n    //[0]:row; [1]:column; [2]:before value; [3]:update value; [4]:bool? don't know\n    let message = {}\n    message['action'] = 'write';\n    message['sheet']=0 //todo how to get the sheet name?\n    message['column'] = args[1];\n    message['row'] = args[0];\n    message['user'] = userid;\n    message['path'] = filename;\n    message['updateData']=JSON.stringify(args[3])\n    console.log(message);\n    return message\n  }\n\n\n\n  /**\n   * Usage: Frame selection or trigger after setting selection\n   * Parameter:\n   * {Object} [sheet]: Current worksheet object\n   * {Object | Array} [range]: Selection area, may be multiple selection areas\n   */\n    // attention : I use cellEditBefore instead of this one. because it's easier.\n    // you can select a range of many cells, but can only edit a cell at once\n  const rangeSelect = (...args) => {\n    //get lock\n    console.log('rangeSelect---------------------------');\n      if(cancel===1) {\n        cancel = 0;\n        console.log('cancel')\n        //cancel, so unlock\n        sendJsonMessage(constructMessageFromRangeSelect(...args))\n      }\n  };\n  const  constructMessageFromRangeSelect=(...args)=>{\n    let message = {}\n    message['action'] = 'unlock';\n    message['sheet']=0;//todo\n    message['column'] = args[1][0].column[0];\n    message['row'] = args[1][0].row[0];\n    message['user'] = userid;\n    message['path'] = filename;\n    console.log(message);\n    return message\n  }\n\n\n  const cellEditBefore = (...args) => {\n    console.log('cellEditBefore---------------------------');\n    //cannot get sheet name ??? emmmm, but setCellValue API needn't it too???\n    console.log('column: ',args[0][0].column[0]);\n    console.log('row: ',args[0][0].row[0]);\n    sendJsonMessage(constructMessageFromCellEdit(...args));\n    cancel=1;\n  };\n  const  constructMessageFromCellEdit=(...args)=>{\n    let message = {}\n    message['action'] = 'lock';\n    message['sheet']=0;//todo\n    message['column'] = args[0][0].column[0];\n    message['row'] = args[0][0].row[0];\n    message['user'] = userid;\n    message['path'] = filename;\n    console.log(message);\n    return message\n  }\n\n  console.log('Connection------------------------------: ' + connectionStatus);\n\n\n  return (\n    <>\n      <Sheet\n        options={{\n          data: null,\n          myFolderUrl: '/',\n          loadUrl:loadUrl,\n          title: filename,\n          gridKey:filename,\n          hook: { cellUpdateBefore, cellUpdated, rangeSelect,cellEditBefore },\n        }}\n        className=\"sheet-fullpage\"\n        {...props}\n      />\n    </>\n  );\n};\n\nexport default SheetPage;\n","import React from 'react';\nimport './App.css';\nimport {  NavPage, SheetPage } from './component';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nconst Home = () => (\n  <div className=\"bg-gray-100 min-h-screen h-full w-screen p-4\">\n    <div className=\"h-100 w-9/12 my-auto mx-auto flex items-center justify-center align-center font-sans\">\n      <NavPage />\n    </div>\n  </div>\n);\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/sheet/:filename/:userid\">\n          <SheetPage />\n        </Route>\n        <Route path=\"/\">\n          <Home />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}